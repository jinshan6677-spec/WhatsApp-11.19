# 快捷回复功能使用指南

## 目录

1. [功能概述](#功能概述)
2. [快速开始](#快速开始)
3. [操作面板使用](#操作面板使用)
4. [管理界面使用](#管理界面使用)
5. [高级功能](#高级功能)
6. [常见问题](#常见问题)
7. [最佳实践](#最佳实践)

---

## 功能概述

快捷回复功能是 WhatsApp 桌面客户端的核心功能模块，旨在提升客服人员的工作效率。通过预设的回复模板，您可以：

- ✅ 快速发送常用回复内容
- ✅ 支持文本、图片、音频、视频、图文混合、名片等多种媒体类型
- ✅ 与翻译系统深度集成，支持原文或翻译后发送
- ✅ 通过分组管理大量模板
- ✅ 每个账号拥有独立的模板库

### 核心优势

- **提升效率**: 预设常用回复，一键发送，节省时间
- **多媒体支持**: 支持多种内容类型，满足不同场景需求
- **智能翻译**: 自动翻译回复内容，轻松应对多语言客户
- **灵活管理**: 分组、搜索、批量操作，轻松管理大量模板
- **数据隔离**: 每个账号独立配置，互不干扰

---

## 快速开始

### 访问快捷回复功能

快捷回复功能已完全集成到主应用中，您可以通过以下方式访问：

**方式一：侧边栏按钮**
1. 在主界面右侧找到"快捷回复"图标（💬 消息气泡图标）
2. 点击图标，快捷回复操作面板将在聊天界面右侧打开

**方式二：快捷键**
- 使用快捷键快速打开/关闭快捷回复面板（如果已配置）

### 第一步：打开快捷回复面板

1. 在主界面右侧找到"快捷回复"图标
2. 点击图标，快捷回复操作面板将在聊天界面右侧打开

### 第二步：创建第一个模板

1. 点击操作面板顶部的"编辑管理"图标
2. 在管理界面中，点击"新建分组"创建一个分组（如"常用问候"）
3. 选择分组，点击"+"图标，选择"添加模板"
4. 选择模板类型（如"文本"）
5. 输入模板标签（如"问候语"）和内容（如"您好，有什么可以帮您？"）
6. 点击"保存"

### 第三步：使用模板

1. 返回聊天界面，打开快捷回复操作面板
2. 找到刚创建的模板
3. 点击"发送"按钮，模板内容将直接发送到当前聊天窗口

🎉 恭喜！您已经成功创建并使用了第一个快捷回复模板。

---

## 操作面板使用

操作面板是快捷回复的核心界面，显示在聊天界面右侧，用于快速选择和发送模板。

### 界面布局

```
┌─────────────────────────────┐
│  快捷回复  🔄 ✏️ 📋 ⚙️      │  ← 标题和工具栏
├─────────────────────────────┤
│  ⚪ 原文发送  ⚪ 翻译后发送   │  ← 发送模式选择
├─────────────────────────────┤
│  🔍 请输入关键词...          │  ← 搜索框
├─────────────────────────────┤
│  ▼ 常用问候                  │  ← 分组
│    1. 问候语                 │  ← 模板
│       您好，有什么可以...     │
│       [发送] [输入框提示]     │
│    2. 再见                   │
│       感谢您的咨询...         │
│       [发送] [输入框提示]     │
│  ▶ 产品介绍                  │  ← 折叠的分组
└─────────────────────────────┘
```

### 工具栏功能

- **🔄 刷新**: 重新加载模板库
- **✏️ 编辑管理**: 打开管理界面
- **📋 复制**: 复制模板内容
- **⚙️ 设置**: 导入/导出、清空缓存等

### 发送模式

#### 原文发送
- 直接发送模板的原始内容
- 适用于不需要翻译的场景

#### 翻译后发送
- 先翻译模板内容，再发送翻译后的内容
- 使用您在翻译设置中配置的翻译引擎
- 适用于与不同语言客户沟通的场景

### 搜索功能

1. 在搜索框中输入关键词
2. 系统会实时过滤模板列表
3. 搜索范围包括：
   - 模板标签
   - 模板内容
   - 分组名称
4. 清空搜索框可恢复显示所有模板

### 分组操作

- **展开/折叠**: 点击分组名称左侧的箭头图标
- **查看模板**: 展开分组后，可以看到该分组下的所有模板

### 模板操作

#### 发送按钮
- 点击"发送"按钮，根据当前选择的发送模式发送模板内容
- 发送成功后会显示绿色对勾提示
- 发送失败会显示红色叉号和错误信息

#### 输入框提示按钮
- 点击"输入框提示"按钮，将模板内容插入到聊天输入框中
- 插入后可以继续编辑内容
- 适用于需要个性化修改的场景

### 模板预览

不同类型的模板有不同的预览方式：

- **文本模板**: 显示前两行文本内容
- **图片模板**: 显示图片缩略图，左上角有"图"字标识
- **音频模板**: 显示播放器控件（播放/暂停、进度条、音量控制）
- **视频模板**: 显示视频缩略图和播放控件
- **图文模板**: 同时显示图片缩略图和文本预览
- **名片模板**: 显示联系人姓名和"名片模板"标识

---

## 管理界面使用

管理界面是独立的窗口，用于预先设置、创建、编辑和组织回复模板。

### 界面布局

```
┌─────────────────────────────────────────────────────────┐
│  快捷回复                          [下载模板] [导入/添加]  │
│  预先设置一些常用的回复内容，帮助您更高效地回复消息        │
├─────────────────────────────────────────────────────────┤
│  📱 WhatsApp  │  分组管理  │  内容编辑区域                │
│               │  🔍 搜索   │  [活跃文本] [活跃图文] ...   │
│               │  □ 常用问候 │  □ 问候语  ✏️ 🗑️            │
│               │  □ 产品介绍 │  □ 再见    ✏️ 🗑️            │
│               │  □ 售后服务 │  □ ...                      │
└─────────────────────────────────────────────────────────┘
```

### 分组管理

#### 创建分组
1. 点击分组列表上方的"新建分组"按钮
2. 输入分组名称
3. 点击"确定"保存

#### 创建子分组
1. 点击父分组旁的"+"图标
2. 选择"新建子分组"
3. 输入子分组名称
4. 点击"确定"保存

#### 编辑分组
1. 点击分组旁的"..."图标
2. 选择"重命名"
3. 输入新的分组名称
4. 点击"确定"保存

#### 删除分组
1. 点击分组旁的"..."图标
2. 选择"删除"
3. 确认删除（注意：删除分组会同时删除该分组下的所有模板）

#### 拖拽排序
- 按住分组并拖动到新位置
- 释放鼠标完成排序

### 模板管理

#### 创建模板
1. 选择一个分组
2. 点击分组旁的"+"图标
3. 选择"添加模板"
4. 选择模板类型（文本、图片、音频、视频、图文、名片）
5. 输入模板标签和内容
6. 点击"保存"

#### 编辑模板
1. 点击模板旁的"✏️"图标
2. 修改模板标签或内容
3. 点击"保存"

#### 删除模板
1. 点击模板旁的"🗑️"图标
2. 确认删除

#### 拖拽排序
- 按住模板并拖动到新位置
- 可以拖动到同一分组内的不同位置
- 也可以拖动到其他分组

### 内容类型标签页

管理界面右侧的内容区域提供了按类型筛选模板的标签页：

- **活跃文本**: 显示所有文本类型模板
- **活跃图文**: 显示所有图文混合类型模板
- **活跃图片**: 显示所有图片类型模板
- **活跃视频**: 显示所有视频类型模板
- **活跃名片**: 显示所有名片类型模板

点击不同的标签页可以快速查看和管理特定类型的模板。

### 批量操作

#### 批量选择
1. 勾选多个模板或分组的复选框
2. 顶部会显示批量操作工具栏

#### 批量移动
1. 选择多个模板
2. 点击"移动到分组"按钮
3. 选择目标分组
4. 点击"确定"

#### 批量删除
1. 选择多个模板或分组
2. 点击"删除"按钮
3. 确认删除

### 导入导出

#### 导出模板
1. 点击顶部的"下载模板"按钮
2. 选择保存位置
3. 输入文件名
4. 点击"保存"

导出的文件是 JSON 格式，包含所有分组和模板数据。

#### 导入模板
1. 点击顶部的"导入/添加"按钮
2. 选择要导入的 JSON 文件
3. 系统会自动解析并导入数据
4. 如果分组名称重复，会自动添加数字后缀

---

## 高级功能

### 模板使用统计

系统会自动记录每个模板的使用情况：

- **使用次数**: 模板被发送的总次数
- **最后使用时间**: 模板最后一次被使用的时间

#### 查看统计
1. 在管理界面点击"统计"按钮
2. 查看所有模板的使用统计报告
3. 报告按使用次数降序排列
4. 点击模板可以跳转到详情页面

### 媒体文件处理

#### 图片模板
- 支持的格式：JPG, PNG, GIF, WebP
- 最大文件大小：16MB
- 上传后会自动生成缩略图

#### 音频模板
- 支持的格式：MP3, WAV, OGG, M4A
- 最大文件大小：16MB
- 可以在操作面板中直接播放预览

#### 视频模板
- 支持的格式：MP4, WebM, MOV
- 最大文件大小：64MB
- 可以在操作面板中直接播放预览

### 翻译集成

快捷回复功能与现有的翻译系统深度集成：

#### 配置翻译引擎
1. 打开翻译设置
2. 选择翻译引擎（谷歌翻译、GPT-4、Gemini、DeepSeek 等）
3. 配置翻译风格（如果支持）
4. 保存设置

#### 使用翻译
1. 在操作面板选择"翻译后发送"模式
2. 点击模板的"发送"按钮
3. 系统会自动翻译模板内容
4. 翻译完成后发送到聊天窗口

#### 翻译降级
如果翻译失败（如网络问题、API 密钥无效等），系统会：
1. 显示错误提示
2. 提供"以原文发送"的备选方案
3. 提供"重试翻译"选项

### 账号级配置隔离

每个 WhatsApp 账号拥有独立的快捷回复配置：

- 模板库独立存储
- 分组结构独立管理
- 配置设置独立保存

#### 切换账号
1. 在主界面切换到不同的 WhatsApp 账号
2. 快捷回复系统会自动加载该账号的配置
3. 在一个账号下的操作不会影响其他账号

### 性能优化

系统内置了多项性能优化功能：

#### 虚拟滚动
- 当模板数量较多时，自动启用虚拟滚动
- 只渲染可见区域的模板，提升性能

#### 搜索防抖
- 搜索输入会自动防抖，避免频繁查询
- 默认延迟 300ms

#### 媒体懒加载
- 图片和视频会延迟加载
- 只有滚动到可见区域时才加载

#### 查询缓存
- 搜索结果会缓存，避免重复查询
- 缓存会在数据变更时自动失效

---

## 常见问题

### Q1: 如何快速找到需要的模板？

**A**: 使用搜索功能：
1. 在操作面板的搜索框中输入关键词
2. 系统会实时过滤模板列表
3. 搜索范围包括模板标签、内容和分组名称

### Q2: 模板标签和模板内容有什么区别？

**A**: 
- **模板标签**: 用于标识和描述模板的简短文字（最多 50 个字符）
- **模板内容**: 实际发送的内容（文本、图片、音频等）

模板标签显示在模板列表中，帮助您快速识别模板。

### Q3: 如何创建多层级的分组结构？

**A**: 
1. 先创建父分组
2. 点击父分组旁的"+"图标
3. 选择"新建子分组"
4. 可以创建最多 3 层的分组结构

### Q4: 删除分组会删除模板吗？

**A**: 是的，删除分组会同时删除该分组下的所有模板和子分组。删除前系统会显示确认对话框，请谨慎操作。

### Q5: 如何备份我的模板库？

**A**: 
1. 在管理界面点击"下载模板"按钮
2. 选择保存位置并保存 JSON 文件
3. 该文件包含所有分组和模板数据
4. 需要恢复时，使用"导入/添加"功能导入该文件

### Q6: 翻译后发送失败怎么办？

**A**: 
1. 检查翻译设置是否正确配置
2. 检查网络连接是否正常
3. 如果翻译引擎不可用，系统会提示您以原文发送
4. 您也可以选择重试翻译

### Q7: 如何将模板移动到其他分组？

**A**: 
有两种方法：
1. **拖拽**: 在管理界面按住模板并拖动到目标分组
2. **批量移动**: 勾选多个模板，点击"移动到分组"按钮，选择目标分组

### Q8: 媒体文件存储在哪里？

**A**: 
媒体文件存储在本地文件系统中：
- 路径：`{userData}/quick-reply/{accountId}/media/`
- 模板中只存储文件路径引用
- 删除模板时会同时删除对应的媒体文件

### Q9: 如何查看模板的使用统计？

**A**: 
1. 在管理界面点击"统计"按钮
2. 查看所有模板的使用次数和最后使用时间
3. 报告按使用次数降序排列
4. 点击模板可以查看详细信息

### Q10: 导入模板时分组名称重复怎么办？

**A**: 
系统会自动处理分组名称冲突：
- 如果分组名称重复，会自动添加数字后缀
- 例如："常用问候" → "常用问候2"
- 模板会正确导入到对应的分组中

---

## 最佳实践

### 1. 合理组织分组结构

**建议**:
- 按业务场景分组（如"售前咨询"、"售后服务"、"投诉处理"）
- 按内容类型分组（如"问候语"、"产品介绍"、"常见问题"）
- 使用子分组细化分类（如"产品介绍" → "手机"、"电脑"、"配件"）

**避免**:
- 分组层级过深（建议不超过 3 层）
- 分组名称过长或不清晰
- 一个分组包含过多模板（建议每个分组不超过 20 个模板）

### 2. 编写清晰的模板标签

**建议**:
- 使用简短、描述性的标签
- 标签应该能够快速识别模板内容
- 对于相似的模板，使用编号区分（如"问候语1"、"问候语2"）

**示例**:
- ✅ "问候语 - 工作日"
- ✅ "产品介绍 - iPhone 15"
- ✅ "常见问题 - 退货流程"
- ❌ "模板1"
- ❌ "新模板"
- ❌ "这是一个用于回复客户关于产品价格咨询的模板"

### 3. 定期维护模板库

**建议**:
- 定期查看使用统计，删除不常用的模板
- 根据业务变化更新模板内容
- 定期导出模板库进行备份
- 清理过时或错误的模板

### 4. 充分利用搜索功能

**建议**:
- 为模板添加关键词标签
- 在模板内容中包含常用关键词
- 使用搜索快速定位模板，而不是滚动查找

### 5. 合理使用翻译功能

**建议**:
- 对于固定的翻译内容，可以创建多语言版本的模板
- 对于需要灵活翻译的内容，使用"翻译后发送"模式
- 定期检查翻译质量，必要时调整模板内容

### 6. 优化媒体文件

**建议**:
- 压缩图片和视频文件，减小文件大小
- 使用合适的文件格式（如 WebP 格式的图片）
- 避免上传过大的文件（建议图片 < 5MB，视频 < 30MB）

### 7. 团队协作

**建议**:
- 制定统一的模板命名规范
- 定期分享和同步模板库（通过导入导出功能）
- 建立模板审核机制，确保内容质量
- 记录模板的创建和修改历史

### 8. 性能优化

**建议**:
- 控制模板总数（建议不超过 500 个）
- 定期清理不使用的模板
- 避免上传过大的媒体文件
- 使用分组折叠功能，减少渲染的模板数量

---

## 集成说明

### 与主应用的集成

快捷回复功能已完全集成到 WhatsApp 桌面应用中：

#### 侧边栏集成
- 快捷回复按钮位于右侧面板菜单中
- 使用消息气泡图标（💬）标识
- 点击按钮可切换快捷回复面板的显示/隐藏

#### 账号切换支持
- 每个 WhatsApp 账号拥有独立的快捷回复配置
- 切换账号时自动加载对应的模板库
- 数据完全隔离，互不影响

#### 翻译服务集成
- 复用主应用的翻译服务配置
- 支持所有已配置的翻译引擎
- 翻译设置与主应用保持同步

#### WhatsApp Web 集成
- 直接发送消息到当前聊天窗口
- 支持插入内容到输入框
- 支持所有媒体类型的发送

#### 数据存储
- 模板数据存储在 `{userData}/quick-reply/{accountId}/` 目录
- 媒体文件存储在 `{userData}/quick-reply/{accountId}/media/` 目录
- 自动创建和管理存储目录

### 系统要求

- **操作系统**：Windows 10+, macOS 10.14+, Ubuntu 20.04+
- **内存**：建议 8GB 以上
- **磁盘空间**：每个账号约需 50-200MB
- **网络**：稳定的互联网连接（用于翻译功能）

### 性能优化

快捷回复功能内置了多项性能优化：

- **虚拟滚动**：大量模板时自动启用，提升渲染性能
- **搜索防抖**：避免频繁查询，默认延迟 300ms
- **媒体懒加载**：图片和视频延迟加载，节省内存
- **查询缓存**：搜索结果缓存，提升响应速度

---

## 技术支持

如果您在使用过程中遇到问题，请：

1. 查看本使用指南的"常见问题"部分
2. 查看系统日志文件（位于 `{userData}/logs/`）
3. 查看 [集成指南](./INTEGRATION_GUIDE.md) 了解技术细节
4. 查看 [API 文档](./API_DOCUMENTATION.md) 了解接口说明
5. 联系技术支持团队

### 相关文档

- 📖 [集成指南](./INTEGRATION_GUIDE.md) - 技术集成说明
- 📖 [API 文档](./API_DOCUMENTATION.md) - 完整的 API 接口文档
- 📖 [性能集成指南](./PERFORMANCE_INTEGRATION_GUIDE.md) - 性能优化指南
- 📖 [代码审查报告](./CODE_REVIEW.md) - 代码质量报告

---

## 更新日志

### v1.0.0 (2024-12-09)
- ✅ 初始版本发布
- ✅ 支持文本、图片、音频、视频、图文、名片等多种模板类型
- ✅ 支持分组管理和层级结构
- ✅ 集成翻译功能
- ✅ 支持导入导出
- ✅ 支持账号级配置隔离
- ✅ 支持使用统计
- ✅ 支持批量操作
- ✅ 支持拖拽排序
- ✅ 内置性能优化
- ✅ 完全集成到主应用
- ✅ 支持侧边栏访问
- ✅ 支持账号切换
- ✅ 支持翻译服务集成
- ✅ 支持 WhatsApp Web 集成

---

**感谢使用快捷回复功能！祝您工作愉快！** 🎉
